<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Converter PDF → Excel | Word • Grátis e Online</title>
  <meta name="description" content="Converta PDFs para Excel (.xlsx) e Word (.docx) automaticamente, com barra de progresso e interface moderna." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#0b1220; --muted:#94a3b8; --brand:#2563eb; --brand-2:#22d3ee; --ok:#16a34a; --border:#1f2a44; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif; color:#e5e7eb;
      background:radial-gradient(1200px 600px at 10% -10%, #1e293b 0%, transparent 60%),
                 radial-gradient(1200px 600px at 100% 0%, #0ea5e9 0%, transparent 60%),
                 linear-gradient(180deg,#0b1220 0%, #0b1120 100%);
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .nav{max-width:1200px;margin:0 auto;padding:16px 20px;display:flex;align-items:center;justify-content:space-between;gap:10px}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:36px;height:36px;border-radius:10px;background:conic-gradient(from 180deg, var(--brand), var(--brand-2));display:grid;place-items:center;box-shadow:0 10px 30px #2563eb40}
    .logo svg{width:20px;height:20px;fill:#fff}
    .brand span{font-weight:800;letter-spacing:.2px}

    .hero{
      position:relative; overflow:hidden;
      background:linear-gradient(120deg, #0b1220 0%, #0b1220a0 40%, transparent 60%), url('https://images.unsplash.com/photo-1551281044-8a5b673a1f2d?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat;
      border-bottom:1px solid var(--border);
    }
    .hero-inner{max-width:1200px;margin:0 auto;padding:48px 20px 24px 20px;display:grid;grid-template-columns:1.2fr .8fr;gap:28px}
    @media (max-width:980px){ .hero-inner{grid-template-columns:1fr} }

    .h-title{font-size:clamp(28px,4vw,44px);line-height:1.05;margin:6px 0 10px;font-weight:800}
    .h-sub{font-size:clamp(15px,2vw,18px);color:#cbd5e1;max-width:60ch}
    .badges{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px}
    .badge{border:1px solid #33415599;background:#0b122088;color:#cbd5e1;padding:6px 10px;border-radius:999px;font-size:12px;display:flex;gap:8px;align-items:center}
    .badge svg{width:14px;height:14px;fill:#93c5fd}

    .card{
      backdrop-filter:saturate(140%) blur(10px);
      background:linear-gradient(180deg, rgba(15,23,42,.55), rgba(2,6,23,.65));
      border:1px solid #33415580; border-radius:18px; padding:18px; box-shadow:0 10px 40px #00000055;
    }
    .card-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .card-title{font-weight:700;letter-spacing:.3px}
    .row{margin:12px 0}
    .dz{border:2px dashed #3b82f6; border-radius:14px; padding:20px; text-align:center; background:#0b122080; transition:.15s; cursor:pointer}
    .dz:hover{background:#0b1220aa}
    .dz .hint{color:#cbd5e1;font-size:14px}
    .dz .filename{margin-top:8px;color:#e5e7eb;font-weight:600}
    button{
      font:inherit; color:#e5e7eb; background:#0b1220cc; border:1px solid var(--border); border-radius:12px; padding:10px 12px;
      outline:none; transition:.15s; width:100%;
    }
    button:focus{box-shadow:0 0 0 6px #60a5fa55}
    .btn-primary{background:linear-gradient(180deg, #2563eb, #1e3a8a);border-color:#1d4ed8;font-weight:700;display:inline-flex;gap:10px;align-items:center;justify-content:center}
    .btn-ghost{background:#0b1220;border-color:#1f2a44}
    button:disabled{opacity:.5;cursor:not-allowed}
    .status{display:inline-flex;gap:8px;align-items:center;color:#cbd5e1;font-size:14px;margin-left:8px}
    .status.ok{color:#86efac}.status.err{color:#fecaca}

    .spinner{width:16px;height:16px;border:2px solid #93c5fd;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite;display:none}
    .loading .spinner{display:inline-block}
    @keyframes spin{to{transform:rotate(360deg)}}

    .progress{margin-top:10px;background:#0b1220; border:1px solid var(--border); border-radius:999px; height:10px; overflow:hidden}
    .progress-bar{height:100%; width:0%; background:linear-gradient(90deg,#22d3ee,#2563eb); transition:width .2s ease}
    .progress-label{margin-top:6px; font-size:12px; color:#cbd5e1}

    .chart-wrap{margin-top:12px;border:1px solid var(--border);border-radius:16px;background:#0b122080;padding:10px}
    .chart-meta{display:flex;justify-content:space-between;color:#cbd5e1;font-size:12px;margin-bottom:6px}

    .features{max-width:1200px;margin:28px auto;padding:0 20px;display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    @media (max-width:980px){.features{grid-template-columns:1fr}}
    .feat{background:#0b1220cc;border:1px solid var(--border);border-radius:16px;padding:18px;display:flex;gap:12px}
    .feat-ic{width:40px;height:40px;border-radius:10px;display:grid;place-items:center;background:#0b1220;border:1px solid #1f2a44}
    .feat-ic svg{width:22px;height:22px;fill:#93c5fd}
    .feat h3{margin:0 0 6px 0;font-size:16px}
    .feat p{margin:0;color:#cbd5e1;font-size:14px}

    .gallery{max-width:1200px;margin:26px auto;padding:0 20px;display:grid;grid-template-columns:2fr 1fr;gap:14px}
    @media (max-width:980px){.gallery{grid-template-columns:1fr}}
    .gimg{border-radius:16px;overflow:hidden;border:1px solid var(--border)}
    .gimg img{width:100%;height:100%;display:block;object-fit:cover;filter:saturate(1.05) contrast(1.02)}

    .footer{max-width:1200px;margin:26px auto 40px;padding:0 20px;color:#94a3b8;display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}

    @media (prefers-color-scheme: light){
      body{color:#0f172a}
      .h-sub,.dz .hint,.feat p,.status,.progress-label,.small{color:#475569}
      .badge{background:#ffffffaa;color:#334155;border-color:#e2e8f0}
      .card{background:linear-gradient(180deg, #ffffffaa, #ffffffd0)}
      .dz{background:#ffffff; border-color:#93c5fd44}
      .feat{background:#fff;border-color:#e2e8f0}
      .feat-ic{background:#f8fafc;border-color:#e2e8f0}
      button{color:#0f172a;background:#fff;border-color:#e2e8f0}
      .btn-primary{color:#fff;background:linear-gradient(180deg, #2563eb, #1e3a8a)}
      .btn-ghost{background:#fff}
      .progress{background:#fff}
      .chart-wrap{background:#fff}
    }

    /* Ajuda (modal) */
    .help-btn{
      font:inherit; padding:8px 12px; border-radius:10px; border:1px solid var(--border);
      background:#0b1220cc; color:#e5e7eb; cursor:pointer;
    }
    .help-btn:focus{ outline:none; box-shadow:0 0 0 6px #60a5fa55; }
    .modal-backdrop{
      position:fixed; inset:0; background:rgba(2,6,23,.6);
      display:none; align-items:center; justify-content:center; z-index:60;
    }
    .modal{
      width:min(920px,90vw); max-height:85vh; overflow:auto;
      background:linear-gradient(180deg, rgba(15,23,42,.96), rgba(2,6,23,.98));
      border:1px solid #33415580; border-radius:16px; padding:18px 18px 12px;
      color:#e5e7eb; box-shadow:0 30px 80px #0009;
    }
    .modal header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:6px}
    .modal h2{font-size:20px;margin:0}
    .modal .close{background:transparent;border:1px solid var(--border);color:inherit;border-radius:10px;padding:6px 10px;cursor:pointer}
    .modal section{border:1px solid var(--border);border-radius:12px;padding:12px;background:#0b122088;margin-top:10px}
    .modal h3{margin:0 0 6px 0;font-size:16px}
    .modal ul{margin:0 0 0 16px;padding:0}
    .modal li{margin:4px 0}
    .badge-k{font-size:12px;border:1px solid var(--border);padding:2px 6px;border-radius:6px}
  </style>
</head>
<body>
  <header class="nav" aria-label="Topo">
    <div class="brand">
      <div class="logo" aria-hidden="true">
        <svg viewBox="0 0 24 24"><path d="M6 4h7l5 5v9a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Zm7 0v5h5"/></svg>
      </div>
      <span>PDF Converter</span>
    </div>
    <button id="helpBtn" class="help-btn" aria-haspopup="dialog" aria-controls="helpModal">❓ Ajuda</button>
  </header>

  <section class="hero">
    <div class="hero-inner">
      <div>
        <div class="badges">
          <span class="badge"><svg viewBox="0 0 24 24"><path d="M20 7L9 18l-5-5"/></svg> 100% grátis</span>
          <span class="badge"><svg viewBox="0 0 24 24"><path d="M6 10V7a6 6 0 0 1 12 0v3M5 10h14v10"/></svg> HTTPS seguro</span>
          <span class="badge"><svg viewBox="0 0 24 24"><path d="M12 12a5 5 0 1 0-5-5"/></svg> Sem cadastro</span>
        </div>
        <h1 class="h-title">Converta PDF para <span style="color:#93c5fd">Excel</span> e <span style="color:#86efac">Word</span> automaticamente</h1>
        <p class="h-sub">Você só envia o arquivo. Nós escolhemos a melhor extração e te entregamos a planilha ou o documento.</p>
      </div>

      <div class="card" role="region" aria-label="Conversor PDF">
        <div class="card-head">
          <div class="card-title">Conversor</div>
          <div class="small" id="quota">Tamanho máx: 20&nbsp;MB</div>
        </div>

        <div class="row">
          <div id="drop" class="dz" tabindex="0" role="button" aria-controls="file" aria-label="Selecione ou arraste um PDF">
            <div class="hint">Arraste o PDF aqui ou <u>clique</u> para selecionar</div>
            <div id="filename" class="filename" aria-live="polite"></div>
          </div>
          <input id="file" type="file" accept="application/pdf" hidden />
        </div>

        <div class="row" style="display:flex;gap:10px;align-items:center">
          <button id="btnExcel" class="btn-primary" disabled><span class="spinner" aria-hidden="true"></span><span>Para Excel (.xlsx)</span></button>
          <button id="btnWord" class="btn-ghost"   disabled><span class="spinner" aria-hidden="true"></span><span>Para Word (.docx)</span></button>
          <span id="status" class="status" aria-live="polite"></span>
        </div>

        <div class="progress"><div id="pbar" class="progress-bar"></div></div>
        <div id="plabel" class="progress-label" aria-live="polite" aria-atomic="true"></div>

        <div class="chart-wrap">
          <div class="chart-meta"><span>Velocidade de upload</span><span id="vmax">—</span></div>
          <canvas id="chart" height="140" style="width:100%"></canvas>
        </div>
      </div>
    </div>
  </section>

  <section class="features" aria-label="Recursos">
    <article class="feat">
      <div class="feat-ic"><svg viewBox="0 0 24 24"><path d="M4 7h16M7 3h10M6 11h12M5 15h14M4 19h16"/></svg></div>
      <div><h3>Planilhas limpas</h3><p>Detecta múltiplas tabelas, cabeçalho persistente e tipagem de números/datas.</p></div>
    </article>
    <article class="feat">
      <div class="feat-ic"><svg viewBox="0 0 24 24"><path d="M12 3l7 4v6c0 5-7 8-7 8S5 18 5 13V7l7-4z"/></svg></div>
      <div><h3>Privado</h3><p>Upload seguro via HTTPS. Arquivos não são guardados após a conversão.</p></div>
    </article>
    <article class="feat">
      <div class="feat-ic"><svg viewBox="0 0 24 24"><path d="M3 12h18M3 6h18M3 18h18"/></svg></div>
      <div><h3>Feedback em tempo real</h3><p>Barra de progresso, porcentagem e medição de velocidade.</p></div>
    </article>
  </section>

  <section class="gallery" aria-label="Exemplos visuais">
    <div class="gimg"><img src="https://images.unsplash.com/photo-1555066931-4365d14bab8c?q=80&w=1600&auto=format&fit=crop" alt="Mesa de trabalho com notebook e planilha" loading="lazy"/></div>
    <div class="gimg"><img src="https://images.unsplash.com/photo-1517433456452-f9633a875f6f?q=80&w=1600&auto=format&fit=crop" alt="Documento de texto em tela" loading="lazy"/></div>
  </section>

  <footer class="footer">
    <div>© <span id="y"></span> PDF Converter — feito por natanjs01</div>
    <div class="small">Backend: <code>converter-pdf-01gy.onrender.com</code> (auto)</div>
  </footer>

  <!-- Ajuda -->
  <div id="helpModalBackdrop" class="modal-backdrop" role="presentation" hidden>
    <div id="helpModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
      <header>
        <h2 id="helpTitle">Como funciona a conversão automática</h2>
        <button class="close" id="helpClose" aria-label="Fechar (Esc)">Fechar ✕</button>
      </header>

      <section>
        <h3>O que eu preciso fazer?</h3>
        <p>Somente selecione o PDF e clique no formato desejado. O sistema identifica o conteúdo e aplica a melhor técnica.</p>
      </section>

      <section>
        <h3>O que acontece por baixo dos panos</h3>
        <ul>
          <li>Detecta <b>duas colunas</b> e extrai corretamente.</li>
          <li>Identifica <b>múltiplas tabelas</b> na mesma página.</li>
          <li>Reconhece relatórios do tipo <b>RPT</b> e repete cabeçalhos/“Loja”.</li>
          <li>Remove ruídos (ex.: “Página X”), tipa <b>datas e valores</b> e ajusta largura das colunas.</li>
          <li>Se o PDF for imagem/escaneado, usa <b>OCR</b> automaticamente.</li>
        </ul>
      </section>

      <p class="small" style="margin-top:10px">
        Atalhos: <span class="badge-k">?</span> abre • <span class="badge-k">Esc</span> fecha • Tab navega no diálogo.
      </p>
    </div>
  </div>

  <script>
    // ====== CONFIG ======
    const API = "https://converter-pdf-01gy.onrender.com";
    const MAX_MB = 20;

    // ====== DOM ======
    const drop = document.getElementById('drop');
    const input = document.getElementById('file');
    const btnExcel = document.getElementById('btnExcel');
    const btnWord  = document.getElementById('btnWord');
    const statusEl = document.getElementById('status');
    const pbar = document.getElementById('pbar');
    const plabel = document.getElementById('plabel');
    const chartEl = document.getElementById('chart');
    const vmaxEl = document.getElementById('vmax');
    document.getElementById('y').textContent = new Date().getFullYear();

    let picked = null, fakeTimer = null;

    const setStatus = (msg, type="") => { statusEl.className = "status" + (type ? " "+type : ""); statusEl.textContent = msg || ""; };
    const setProgress = (pct) => { const v = Math.max(0, Math.min(100, Math.round(pct))); pbar.style.width = v + "%"; plabel.textContent = v + "%"; };
    const startFakeProcessing = () => { let cur = parseInt(pbar.style.width || "0", 10) || 0; clearInterval(fakeTimer);
      fakeTimer = setInterval(()=>{ if(cur<95){cur+=1; setProgress(cur);} else {clearInterval(fakeTimer);} }, 120);
    };
    const stopFakeProcessing = () => clearInterval(fakeTimer);

    // chart
    const ctx = chartEl.getContext('2d');
    let chartData = [], maxV = 0;
    function formatSpeed(bps){ if (bps >= 1024*1024) return (bps/(1024*1024)).toFixed(2) + " MB/s";
      if (bps >= 1024) return (bps/1024).toFixed(1) + " KB/s"; return Math.round(bps) + " B/s"; }
    function drawChart(){
      const W = chartEl.clientWidth, H = chartEl.height, r = window.devicePixelRatio || 1;
      chartEl.width = W * r; ctx.setTransform(r,0,0,r,0,0); ctx.clearRect(0,0,W,H);
      ctx.strokeStyle="rgba(148,163,184,.35)"; ctx.lineWidth=1; ctx.beginPath(); ctx.moveTo(36,8); ctx.lineTo(36,H-20); ctx.lineTo(W-8,H-20); ctx.stroke();
      if(chartData.length<2) return;
      const t0=chartData[0].t, t1=chartData[chartData.length-1].t, dt=Math.max(1,t1-t0), vmax=Math.max(1,maxV);
      ctx.strokeStyle="rgba(148,163,184,.18)";
      for(let i=1;i<=3;i++){ const y=8+(H-28)*(1-i/3); ctx.beginPath(); ctx.moveTo(36,y); ctx.lineTo(W-8,y); ctx.stroke(); }
      ctx.strokeStyle="#60a5fa"; ctx.lineWidth=2; ctx.beginPath();
      chartData.forEach((p,i)=>{ const x=36+(W-44)*((p.t-t0)/dt); const y=8+(H-28)*(1-(p.v/vmax)); if(i===0)ctx.moveTo(x,y); else ctx.lineTo(x,y); }); ctx.stroke();
      vmaxEl.textContent = "pico: " + formatSpeed(maxV);
    }
    window.addEventListener('resize', drawChart);

    function handleFile(f){
      if(!f) return;
      if(f.type !== "application/pdf"){ alert("Selecione um arquivo PDF."); return; }
      if(f.size > MAX_MB*1024*1024){ alert(`Limite de ${MAX_MB} MB.`); return; }
      picked = f; document.getElementById('filename').textContent = "Selecionado: " + f.name;
      btnExcel.disabled = false; btnWord.disabled = false;
      setStatus(""); setProgress(0); plabel.textContent = "";
      chartData = []; maxV = 0; drawChart();
    }

    // dropzone
    drop.addEventListener('click', ()=> input.click());
    drop.addEventListener('keydown', (e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); input.click(); }});
    drop.addEventListener('dragover', (e)=>{ e.preventDefault(); drop.style.opacity=.95; });
    drop.addEventListener('dragleave', ()=>{ drop.style.opacity=1; });
    drop.addEventListener('drop', (e)=>{ e.preventDefault(); drop.style.opacity=1; handleFile(e.dataTransfer.files?.[0]); });
    input.addEventListener('change', ()=> handleFile(input.files?.[0]));

    // envio
    function convert(format){
      if(!picked) return;
      const btn = format === 'excel' ? btnExcel : btnWord;
      const other = format === 'excel' ? btnWord : btnExcel;

      btn.disabled = true; other.disabled = true;
      btn.classList.add('loading'); setStatus("Enviando arquivo…"); setProgress(1);

      const fd = new FormData(); fd.append('file', picked);
      const url = `${API}/convert?to=${encodeURIComponent(format)}`; // auto tudo

      const xhr = new XMLHttpRequest();
      xhr.open("POST", url, true); xhr.responseType = "blob";

      chartData = []; let lastLoaded = 0; let lastT = performance.now(); maxV = 0; drawChart();

      xhr.upload.onprogress = (e) => {
        if (e.lengthComputable) {
          const pct = (e.loaded / e.total) * 75; setProgress(pct); plabel.textContent = `Enviando… ${Math.round(pct)}%`;
          const now = performance.now(), dt = (now - lastT)/1000, db = e.loaded - lastLoaded;
          if (dt > 0.08) {
            const bps = db/dt; maxV = Math.max(maxV, bps);
            chartData.push({t: now, v: bps}); lastLoaded = e.loaded; lastT = now; drawChart();
          }
        }
      };

      xhr.onloadstart = ()=> setProgress(5);

      xhr.onload = () => {
        stopFakeProcessing();
        if (xhr.status >= 200 && xhr.status < 300) {
          setStatus("Finalizando…"); setProgress(100);
          const blob = xhr.response;
          const outName = picked.name.replace(/\.pdf$/i,'') + (format === 'excel' ? '.xlsx' : '.docx');
          const link = URL.createObjectURL(blob); const a = document.createElement('a');
          a.href = link; a.download = outName; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(link);
          setStatus("Pronto!", "ok");
        } else {
          setStatus("Erro ao converter", "err");
          const reader = new FileReader(); reader.onload = () => alert("Falha na conversão: " + reader.result);
          reader.readAsText(xhr.response || new Blob(["Erro " + xhr.status]));
        }
        btn.classList.remove('loading'); btn.disabled = false; other.disabled = false;
      };

      xhr.onerror = () => {
        stopFakeProcessing(); setStatus("Erro de conexão", "err");
        btn.classList.remove('loading'); btn.disabled = false; other.disabled = false;
        alert("Não foi possível conectar ao servidor. Verifique sua internet e tente novamente.");
      };

      xhr.onloadend = () => stopFakeProcessing();

      xhr.send(fd);

      setTimeout(() => {
        setStatus("Processando…");
        const cur = parseInt(pbar.style.width || "0", 10) || 0;
        if (cur < 80) setProgress(80);
        startFakeProcessing();
      }, 400);
    }

    btnExcel.addEventListener('click', ()=> convert('excel'));
    btnWord .addEventListener('click', ()=> convert('word'));

    // ===== Modal de Ajuda =====
    (function(){
      const openBtn = document.getElementById('helpBtn');
      const modal   = document.getElementById('helpModal');
      const closeBtn= document.getElementById('helpClose');
      const backdrop= document.getElementById('helpModalBackdrop');
      let lastFocus = null;

      function openModal(){
        lastFocus = document.activeElement;
        backdrop.hidden = false;
        backdrop.style.display = 'flex';
        const title = document.getElementById('helpTitle');
        title.setAttribute('tabindex','-1');
        title.focus();
        document.addEventListener('keydown', onKey);
        document.addEventListener('focus', trapFocus, true);
      }
      function closeModal(){
        backdrop.style.display = 'none';
        backdrop.hidden = true;
        document.removeEventListener('keydown', onKey);
        document.removeEventListener('focus', trapFocus, true);
        if (lastFocus && typeof lastFocus.focus === 'function') lastFocus.focus();
      }
      function onKey(e){
        if (e.key === 'Escape') { e.preventDefault(); closeModal(); }
        if ((e.key === '?' || (e.shiftKey && e.key === '/')) && backdrop.hidden) {
          e.preventDefault(); openModal();
        }
        if (e.key === 'Tab' && !backdrop.hidden) {
          const f = modal.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
          const focusables = Array.from(f).filter(el => !el.hasAttribute('disabled'));
          if (focusables.length) {
            const first = focusables[0], last = focusables[focusables.length - 1];
            if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
            else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
          }
        }
      }
      function trapFocus(e){
        if (!modal.contains(e.target)) {
          e.stopPropagation();
          modal.focus();
        }
      }
      openBtn?.addEventListener('click', openModal);
      document.getElementById('helpClose')?.addEventListener('click', closeModal);
      backdrop?.addEventListener('click', (e)=>{ if (e.target === backdrop) closeModal(); });
      document.addEventListener('keydown', (e)=>{
        if ((e.key === '?' || (e.shiftKey && e.key === '/')) && backdrop.hidden) {
          e.preventDefault(); openModal();
        }
      });
    })();

  </script>
</body>
</html>
