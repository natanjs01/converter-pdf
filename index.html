<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Converter PDF ‚Üí Excel | Word ‚Ä¢ Gr√°tis e Online</title>
  <meta name="description" content="Converta PDFs para Excel (.xlsx) e Word (.docx) com qualidade. Gr√°tis, seguro e sem cadastro." />
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{ --bg:#0b1220; --muted:#94a3b8; --brand:#2563eb; --brand-2:#22d3ee; --ok:#16a34a; --border:#1f2a44; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;color:#e5e7eb;
      background:radial-gradient(1200px 600px at 10% -10%, #1e293b 0%, transparent 60%),
                 radial-gradient(1200px 600px at 100% 0%, #0ea5e9 0%, transparent 60%),
                 linear-gradient(180deg,#0b1220 0%, #0b1120 100%);}
    .nav{max-width:1200px;margin:0 auto;padding:16px 20px;display:flex;align-items:center;justify-content:space-between}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:36px;height:36px;border-radius:10px;background:conic-gradient(from 180deg, var(--brand), var(--brand-2));display:grid;place-items:center;box-shadow:0 10px 30px #2563eb40}
    .logo svg{width:20px;height:20px;fill:#fff}
    .brand span{font-weight:800;letter-spacing:.2px}
    .hero{position:relative;overflow:hidden;background:linear-gradient(120deg,#0b1220 0%,#0b1220a0 40%,transparent 60%), url('https://images.unsplash.com/photo-1551281044-8a5b673a1f2d?q=80&w=1600&auto=format&fit=crop') center/cover no-repeat;border-bottom:1px solid var(--border)}
    .hero-inner{max-width:1200px;margin:0 auto;padding:48px 20px 24px;display:grid;grid-template-columns:1.2fr .8fr;gap:28px}
    @media (max-width:980px){.hero-inner{grid-template-columns:1fr}}
    .h-title{font-size:clamp(28px,4vw,44px);line-height:1.05;margin:6px 0 10px;font-weight:800}
    .h-sub{font-size:clamp(15px,2vw,18px);color:#cbd5e1;max-width:60ch}
    .badges{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px}
    .badge{border:1px solid #33415599;background:#0b122088;color:#cbd5e1;padding:6px 10px;border-radius:999px;font-size:12px;display:flex;gap:8px;align-items:center}
    .card{backdrop-filter:saturate(140%) blur(10px);background:linear-gradient(180deg,rgba(15,23,42,.55),rgba(2,6,23,.65));border:1px solid #33415580;border-radius:18px;padding:18px;box-shadow:0 10px 40px #00000055}
    .card-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .dz{border:2px dashed #3b82f6;border-radius:14px;padding:20px;text-align:center;background:#0b122080;cursor:pointer}
    .dz:hover{background:#0b1220aa}
    .dz .filename{margin-top:8px;color:#e5e7eb;font-weight:600}
    select,button{font:inherit;color:#e5e7eb;background:#0b1220cc;border:1px solid var(--border);border-radius:12px;padding:10px 12px;outline:none;transition:.15s;width:100%}
    select:focus,button:focus{box-shadow:0 0 0 6px #60a5fa55}
    button{background:linear-gradient(180deg,#2563eb,#1e3a8a);border-color:#1d4ed8;font-weight:700;display:inline-flex;gap:10px;align-items:center;justify-content:center}
    button:disabled{opacity:.5;cursor:not-allowed}
    .status{display:inline-flex;gap:8px;align-items:center;color:#cbd5e1;font-size:14px;margin-left:8px}
    .status.ok{color:#86efac}.status.err{color:#fecaca}
    .spinner{width:16px;height:16px;border:2px solid #93c5fd;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite;display:none}
    .loading .spinner{display:inline-block}@keyframes spin{to{transform:rotate(360deg)}}
    .progress{margin-top:10px;background:#0b1220;border:1px solid var(--border);border-radius:999px;height:10px;overflow:hidden}
    .progress-bar{height:100%;width:0%;background:linear-gradient(90deg,#22d3ee,#2563eb);transition:width .2s ease}
    .progress-label{margin-top:6px;font-size:12px;color:#cbd5e1}
    .adv{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:8px}
    .chart-wrap{margin-top:12px;border:1px solid var(--border);border-radius:16px;background:#0b122080;padding:10px}
    .chart-meta{display:flex;justify-content:space-between;color:#cbd5e1;font-size:12px;margin-bottom:6px}
    .features{max-width:1200px;margin:28px auto;padding:0 20px;display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
    @media (max-width:980px){.features{grid-template-columns:1fr}}
    .feat{background:#0b1220cc;border:1px solid var(--border);border-radius:16px;padding:18px;display:flex;gap:12px}
    .footer{max-width:1200px;margin:26px auto 40px;padding:0 20px;color:#94a3b8;display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}
    @media (prefers-color-scheme: light){body{color:#0f172a}.progress{background:#fff}}
  </style>
</head>
<body>
  <header class="nav"><div class="brand"><div class="logo"><svg viewBox="0 0 24 24"><path d="M6 4h7l5 5v9a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2Zm7 0v5h5"/></svg></div><span>PDF Converter</span></div></header>

  <section class="hero">
    <div class="hero-inner">
      <div>
        <div class="badges">
          <span class="badge">100% gr√°tis</span><span class="badge">HTTPS seguro</span><span class="badge">Sem cadastro</span>
        </div>
        <h1 class="h-title">Converta PDF para <span style="color:#93c5fd">Excel</span> e <span style="color:#86efac">Word</span></h1>
        <p class="h-sub">Acompanhe progresso, velocidade e escolha a melhor engine para seu arquivo.</p>
      </div>

      <div class="card" role="region" aria-label="Conversor PDF">
        <div class="card-head"><div style="font-weight:700">Conversor</div><div class="small">Tamanho m√°x: 20 MB</div></div>

        <div class="dz" id="drop" tabindex="0" role="button" aria-controls="file" aria-label="Selecione ou arraste um PDF">
          <div>Arraste o PDF aqui ou <u>clique</u> para selecionar</div>
          <div id="filename" class="filename" aria-live="polite"></div>
        </div>
        <input id="file" type="file" accept="application/pdf" hidden />

        <div class="row" style="margin-top:12px">
          <label class="small" for="format">Formato de sa√≠da</label>
          <select id="format"><option value="excel">Excel (.xlsx)</option><option value="word">Word (.docx)</option></select>
        </div>

        <div class="row">
          <label class="small">Op√ß√µes avan√ßadas (Excel)</label>
          <div class="adv">
            <div><label class="small" for="mode">Modo</label>
              <select id="mode"><option value="auto">Auto (recomendado)</option><option value="rpt">Relat√≥rios (RPT)</option><option value="table">Tabela</option><option value="form">Formul√°rio</option></select>
            </div>
            <div><label class="small" for="engine">Engine</label>
              <select id="engine"><option value="auto">Auto (melhor por p√°gina)</option><option value="plumber">Plumber (r√°pido)</option><option value="camelot">Camelot (tabelas)</option><option value="tabula">Tabula (tabelas)</option><option value="ocr">OCR (escaneado)</option></select>
            </div>
          </div>
        </div>

        <div class="row" style="display:flex;gap:10px;align-items:center;margin-top:12px">
          <button id="btn" disabled><span class="spinner"></span><span id="btnText">Converter agora</span></button>
          <span id="status" class="status"></span>
        </div>

        <div class="progress"><div id="pbar" class="progress-bar"></div></div>
        <div id="plabel" class="progress-label"></div>

        <div class="chart-wrap">
          <div class="chart-meta"><span>Velocidade de upload</span><span id="vmax">‚Äî</span></div>
          <canvas id="chart" height="140" style="width:100%"></canvas>
        </div>
      </div>
    </div>
  </section>

  <section class="features">
    <div class="feat"><div>‚úîÔ∏è</div><div><h3>Planilhas limpas</h3><p>Heur√≠sticas de colunas e detectores para reduzir mistura.</p></div></div>
    <div class="feat"><div>üîí</div><div><h3>Privado</h3><p>Arquivos n√£o s√£o armazenados ap√≥s a convers√£o.</p></div></div>
    <div class="feat"><div>‚ö°</div><div><h3>Feedback em tempo real</h3><p>Progresso, % e pico de velocidade.</p></div></div>
  </section>

  <footer class="footer"><div>¬© <span id="y"></span> PDF Converter ‚Äî natanjs01</div><div class="small">Backend: <code>converter-pdf-01gy.onrender.com</code></div></footer>

  <script>
    const API="https://converter-pdf-01gy.onrender.com", MAX_MB=20;
    const drop=document.getElementById('drop'), input=document.getElementById('file'), btn=document.getElementById('btn');
    const btnText=document.getElementById('btnText'), format=document.getElementById('format'), mode=document.getElementById('mode'), engine=document.getElementById('engine');
    const statusEl=document.getElementById('status'), filenameEl=document.getElementById('filename'), pbar=document.getElementById('pbar'), plabel=document.getElementById('plabel');
    const chartEl=document.getElementById('chart'), vmaxEl=document.getElementById('vmax'); document.getElementById('y').textContent=new Date().getFullYear();
    let picked=null, fakeTimer=null;

    const setStatus=(m,t="")=>{ statusEl.className="status"+(t?" "+t:""); statusEl.textContent=m||""; };
    const setProgress=(p)=>{ const v=Math.max(0,Math.min(100,Math.round(p))); pbar.style.width=v+"%"; plabel.textContent=v+"%"; };
    const startFake=()=>{ let cur=parseInt(pbar.style.width||"0",10)||0; clearInterval(fakeTimer); fakeTimer=setInterval(()=>{ if(cur<95){cur+=1; setProgress(cur);} else {clearInterval(fakeTimer);} },120); };
    const stopFake=()=>clearInterval(fakeTimer);

    const ctx=chartEl.getContext('2d'); let chartData=[], maxV=0;
    function formatSpeed(bps){ if(bps>=1024*1024) return (bps/(1024*1024)).toFixed(2)+" MB/s"; if(bps>=1024) return (bps/1024).toFixed(1)+" KB/s"; return Math.round(bps)+" B/s"; }
    function drawChart(){ const W=chartEl.clientWidth,H=chartEl.height,r=window.devicePixelRatio||1; chartEl.width=W*r; ctx.setTransform(r,0,0,r,0,0); ctx.clearRect(0,0,W,H);
      ctx.strokeStyle="rgba(148,163,184,.35)"; ctx.beginPath(); ctx.moveTo(36,8); ctx.lineTo(36,H-20); ctx.lineTo(W-8,H-20); ctx.stroke();
      if(chartData.length<2) return; const t0=chartData[0].t,t1=chartData[chartData.length-1].t,dt=Math.max(1,t1-t0),vmax=Math.max(1,maxV);
      ctx.strokeStyle="rgba(148,163,184,.18)"; for(let i=1;i<=3;i++){ const y=8+(H-28)*(1-i/3); ctx.beginPath(); ctx.moveTo(36,y); ctx.lineTo(W-8,y); ctx.stroke(); }
      ctx.strokeStyle="#60a5fa"; ctx.lineWidth=2; ctx.beginPath();
      chartData.forEach((p,i)=>{ const x=36+(W-44)*((p.t-t0)/dt), y=8+(H-28)*(1-(p.v/vmax)); if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y); }); ctx.stroke();
      vmaxEl.textContent="pico: "+formatSpeed(maxV);
    }
    window.addEventListener('resize', drawChart);

    function handleFile(f){ if(!f) return; if(f.type!=="application/pdf"){alert("Selecione um PDF.");return;}
      if(f.size>MAX_MB*1024*1024){alert(`Limite de ${MAX_MB} MB.`);return;}
      picked=f; filenameEl.textContent="Selecionado: "+f.name; btn.disabled=false; setStatus(""); setProgress(0); chartData=[]; maxV=0; drawChart(); }

    drop.addEventListener('click',()=>input.click());
    drop.addEventListener('keydown',(e)=>{ if(e.key==='Enter'||e.key===' '){ e.preventDefault(); input.click(); }});
    drop.addEventListener('dragover',(e)=>{ e.preventDefault(); drop.style.opacity=.95; });
    drop.addEventListener('dragleave',()=>{ drop.style.opacity=1; });
    drop.addEventListener('drop',(e)=>{ e.preventDefault(); drop.style.opacity=1; handleFile(e.dataTransfer.files?.[0]); });
    input.addEventListener('change',()=>handleFile(input.files?.[0]));

    btn.addEventListener('click',()=>{
      if(!picked) return;
      btn.disabled=true; btn.classList.add('loading'); btnText.textContent="Enviando‚Ä¶"; setStatus("Enviando arquivo‚Ä¶"); setProgress(1);
      const fd=new FormData(); fd.append('file', picked);
      const url=`${API}/convert?to=${encodeURIComponent(format.value)}${format.value==='excel' ? `&mode=${encodeURIComponent(mode.value)}&engine=${encodeURIComponent(engine.value)}` : ""}`;
      const xhr=new XMLHttpRequest(); xhr.open("POST", url, true); xhr.responseType="blob";

      chartData=[]; let lastLoaded=0; let lastT=performance.now(); maxV=0; drawChart();
      xhr.upload.onprogress=(e)=>{ if(e.lengthComputable){ const pct=(e.loaded/e.total)*75; setProgress(pct); plabel.textContent=`Enviando‚Ä¶ ${Math.round(pct)}%`;
        const now=performance.now(), dt=(now-lastT)/1000, db=e.loaded-lastLoaded; if(dt>0.08){ const bps=db/dt; maxV=Math.max(maxV,bps); chartData.push({t:now,v:bps}); lastLoaded=e.loaded; lastT=now; drawChart(); } } };
      xhr.onloadstart=()=>setProgress(5);
      xhr.onload=()=>{ stopFake(); if(xhr.status>=200&&xhr.status<300){ btnText.textContent="Finalizando‚Ä¶"; setStatus("Finalizando‚Ä¶"); setProgress(100);
          const blob=xhr.response; const outName=picked.name.replace(/\.pdf$/i,'')+(format.value==='excel'?'.xlsx':'.docx');
          const link=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=link; a.download=outName; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(link);
          setStatus("Pronto!","ok"); btnText.textContent="Converter agora";
        } else { setStatus("Erro ao converter","err"); btnText.textContent="Converter agora"; const r=new FileReader(); r.onload=()=>alert("Falha na convers√£o: "+r.result); r.readAsText(xhr.response||new Blob(["Erro "+xhr.status])); }
        btn.classList.remove('loading'); btn.disabled=false; };
      xhr.onerror=()=>{ stopFake(); setStatus("Erro de conex√£o","err"); btn.classList.remove('loading'); btn.disabled=false; btnText.textContent="Converter agora"; alert("N√£o foi poss√≠vel conectar ao servidor."); };
      xhr.onloadend=()=>stopFake();
      xhr.send(fd);
      setTimeout(()=>{ setStatus("Processando‚Ä¶"); const cur=parseInt(pbar.style.width||"0",10)||0; if(cur<80) setProgress(80); btn.classList.add('loading'); btnText.textContent="Processando‚Ä¶"; startFake(); },400);
    });
  </script>
</body>
</html>
